1) inorder to use the proxy one should setup the following iptables rule (as root)
#iptables -t nat -A PREROUTING -p tcp -m tcp -j REDIRECT --to-ports 8110
2) we can also specify the traffic to be intercepetd. example http (port = 80)
# iptables -t nat -A PREROUTING -p tcp -m tcp --dport 80 -j REDIRECT --to-ports 8110
# iptables -t nat -A PREROUTING -p tcp -m tcp --sport 80 -j REDIRECT --to-ports 8110
3) To remove the iptables rules
#iptables -t nat -Z
#iptables -t nat -F
4) For output traffic on the local machine:
# iptables -t nat -A OUTPUT -p tcp -m owner ! --uid-owner root  -j REDIRECT --to-ports 8110
=>  "-m owner ! --uid-owner root" allows to exclude traffic generated by the proxy itself from interception. Obviously we can run the proxy with a specific uid and exclude that uid from interception
